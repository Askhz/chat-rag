Name: chat-rag
Host: 0.0.0.0
Port: 8888

# Logging configuration
Log:
  LogFilePath: "logs/"

# Department configuration
DepartmentApiEndpoint: "http://localhost:1234/work_id?work_id="

# Models supported by function calling
LLM:
  # Endpoint: "https://zgsm.sangfor.com/chat-rag/api/v1/chat/completions"
  # Endpoint: "http://zgsm.sangfor.com/oneapi/v1/chat/completions"
  Endpoint: "http://127.0.0.1:30616/chat-rag/api/v1/chat/completions"

LLMTimeout:
  # Regular mode timeout configuration (æ™®é€šæ¨¡å¼è¶…æ—¶é…ç½®)
  # å•æ¬¡è¿ç»­ç©ºé—²é˜ˆå€¼ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 180000ms (180s)
  IdleTimeoutMs: 180000
  # æ€»ç©ºé—²é¢„ç®—ï¼ˆæ¯«ç§’ï¼‰ï¼Œè·¨é‡è¯•/é™çº§ç´¯è®¡ç©ºé—²æ—¶é•¿ä¸Šé™ï¼Œé»˜è®¤ 180000ms (180s)
  TotalIdleTimeoutMs: 180000

  # Regular mode retry configuration (æ™®é€šæ¨¡å¼é‡è¯•é…ç½®)
  # æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤ 1ï¼ˆå³æ€»å…±å°è¯• 2 æ¬¡ï¼‰
  MaxRetryCount: 1
  # é‡è¯•é—´éš”ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 5000msï¼ˆ5ç§’ï¼‰
  RetryIntervalMs: 5000

# Router configuration (è·¯ç”±é…ç½®)
# Note: This configuration can also be loaded from Nacos
router:
  enabled: false
  strategy: semantic
  semantic:
    analyzer:
      model: "gpt-4"
      timeoutMs: 30000
      totalTimeoutMs: 60000
      maxInputBytes: 10000
    inputExtraction:
      protocol: "openai"
      userJoinSep: "\n\n"
      stripCodeFences: true
      maxUserMessages: 100
      maxHistoryBytes: 2048
      maxHistoryMessages: 5
    routing:
      candidates:
        - modelName: "gpt-4"
          enabled: true
          scores:
            general: 10
      minScore: 5
      fallbackModelName: "gpt-4"

      # Timeout configuration for model degradation scenarios (æ¨¡å‹é™çº§åœºæ™¯çš„è¶…æ—¶é…ç½®)
      idleTimeoutMs: 180000      # å•æ¬¡ç©ºé—²è¶…æ—¶ï¼Œé»˜è®¤ 180000ms (180s)
      totalIdleTimeoutMs: 180000 # æ€»ç©ºé—²è¶…æ—¶é¢„ç®—ï¼Œé»˜è®¤ 180000ms (180s)

      # Retry configuration for model degradation scenarios (æ¨¡å‹é™çº§åœºæ™¯çš„é‡è¯•é…ç½®)
      maxRetryCount: 1           # æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤ 1
      retryIntervalMs: 5000      # é‡è¯•é—´éš”ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 5000ms
    ruleEngine:
      enabled: false
      bodyPrefix: "body."
      headerPrefix: "header."

Redis:
  Addr: "127.0.0.1:6379"

# VIP priority configuration
VIPPriority:
  # Enable setting priority parameter for VIP users
  enabled: false

# Forward configuration
# ä¸åšå¯¹è¯·æ±‚ä¸åšä»»ä½•å¤„ç†ï¼Œåªåšè®°å½•ï¼Œå¯ç”¨æ¥æŠ“åŒ…
forward:
  # Enable forwarding interface
  enabled: true
  # Default target URL for forwarding (optional)
  # If not provided, target URL must be specified in query parameter
  # defaultTarget: "http://zgsm.sangfor.com/"

# Nacos configuration center settings
nacos:
  # Nacos server address
  serverAddr: "localhost"
  # Nacos server port
  serverPort: 8848
  # Nacos gRPC port
  # grpcPort: 9848
  # Nacos namespace (leave empty for default namespace)
  namespace: "ca7a2781-bfa5-4b58-8929-702cdc1f7e06"
  # Nacos group for configuration
  group: "CHAT_RAG"
  # Timeout in seconds for Nacos operations
  timeoutSec: 10
  # Log directory for Nacos client
  logDir: "logs/nacos"
  # Cache directory for Nacos client
  cacheDir: "logs/nacos/cache"

chatMetrics:
  enabled: false
  url: "http://127.0.0.1:8080/internal/indicator/api/v1/chat-indicator"
  method: "PUT"

requestVerify:
  enabled: false
  enabledTimeVerify: false

# ä»£é‡‘åˆ¸æ´»åŠ¨é…ç½®
voucher_activity:
  # æ˜¯å¦å¯ç”¨ä»£é‡‘åˆ¸æ´»åŠ¨åŠŸèƒ½
  enabled: false
  # ç­¾åå¯†é’¥ï¼ˆç”¨äºç”Ÿæˆå’ŒéªŒè¯å…‘æ¢ç ï¼Œè¯·å¦¥å–„ä¿ç®¡ï¼‰
  signingKey: "your-secret-signing-key-change-this-in-production"
  # æ´»åŠ¨åˆ—è¡¨ï¼ˆæ”¯æŒå¤šä¸ªæ´»åŠ¨ï¼‰
  activities:
    # æ´»åŠ¨1 - æ–°å¹´æ´»åŠ¨
    - keyword: "æ–°å¹´ä»£é‡‘åˆ¸"  # æ´»åŠ¨å…³é”®å­—ï¼Œç”¨æˆ·å‘é€æ­¤å…³é”®å­—å¯è§¦å‘å…‘æ¢æ´»åŠ¨
      creditAmount: 100  # æ¯ä¸ªå…‘æ¢ç åŒ…å«çš„ credit æ•°é‡
      voucherExpiryDays: 30  # å…‘æ¢ç è¿‡æœŸå¤©æ•°ï¼ˆä»ç”Ÿæˆä¹‹æ—¥ç®—èµ·ï¼‰
      # æ´»åŠ¨å¼€å§‹æ—¶é—´ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼šYYYY-MM-DDã€YYYY-MM-DDTHHã€YYYY-MM-DDTHH:MMã€YYYY-MM-DDTHH:MM:SSï¼‰
      startTime: "2024-01-01T00:00"
      # æ´»åŠ¨ç»“æŸæ—¶é—´ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼šYYYY-MM-DDã€YYYY-MM-DDTHHã€YYYY-MM-DDTHH:MMã€YYYY-MM-DDTHH:MM:SSï¼‰
      endTime: "2024-02-29T23:59"
      totalQuota: 10000  # å…‘æ¢æ€»é‡é™åˆ¶
      # å…‘æ¢æˆåŠŸè¿”å›æ¨¡æ¿ï¼ˆGo template æ ¼å¼ï¼‰
      # æ”¯æŒå˜é‡ï¼š
      #   {{.VoucherCode}} - å…‘æ¢ç 
      #   {{.Config.CreditAmount}} - credit æ•°é‡
      #   {{.Config.VoucherExpiryDays}} - è¿‡æœŸå¤©æ•°
      successTemplate: |
        ğŸ‰ æ­å–œæ‚¨æˆåŠŸé¢†å–æ–°å¹´ä»£é‡‘åˆ¸ï¼
        å…‘æ¢ç ï¼š{{.VoucherCode}}
        å¯è·å¾—ï¼š{{.Config.CreditAmount}} credit
        æœ‰æ•ˆæœŸï¼š{{.Config.VoucherExpiryDays}} å¤©
        è¯·åœ¨æœ‰æ•ˆæœŸå†…ä½¿ç”¨ã€‚
      # å·²é¢†å–è¿‡çš„æ–‡æ¡ˆï¼ˆGo template æ ¼å¼ï¼‰
      alreadyRedeemedMessage: "æ‚¨å·²ç»é¢†å–è¿‡æ–°å¹´ä»£é‡‘åˆ¸äº†ï¼Œæ¯äººé™é¢†ä¸€æ¬¡å“¦~"
      # å…‘æ¢ç è¿‡æœŸæ–‡æ¡ˆï¼ˆGo template æ ¼å¼ï¼‰
      expiredMessage: "æŠ±æ­‰ï¼Œæ–°å¹´ä»£é‡‘åˆ¸æ´»åŠ¨å·²ç»“æŸï¼Œè¯·å…³æ³¨åç»­æ´»åŠ¨ã€‚"
      # å…‘æ¢é¢åº¦ç”¨å°½æ–‡æ¡ˆï¼ˆGo template æ ¼å¼ï¼‰
      quotaExhaustedMessage: "æŠ±æ­‰ï¼Œæ–°å¹´ä»£é‡‘åˆ¸å·²å‘æ”¾å®Œæ¯•ï¼Œè¯·å…³æ³¨åç»­æ´»åŠ¨ã€‚"

    # æ´»åŠ¨2 - æ˜¥èŠ‚æ´»åŠ¨ï¼ˆç¤ºä¾‹ï¼‰
    - keyword: "æ˜¥èŠ‚ä»£é‡‘åˆ¸"
      creditAmount: 200
      voucherExpiryDays: 45
      startTime: "2024-02-01T00:00"
      endTime: "2024-02-15T23:59"
      totalQuota: 5000
      successTemplate: |
        ğŸ§§ æ­å–œæ‚¨æˆåŠŸé¢†å–æ˜¥èŠ‚ä»£é‡‘åˆ¸ï¼
        å…‘æ¢ç ï¼š{{.VoucherCode}}
        å¯è·å¾—ï¼š{{.Config.CreditAmount}} credit
        æœ‰æ•ˆæœŸï¼š{{.Config.VoucherExpiryDays}} å¤©
        æ–°æ˜¥å¿«ä¹ï¼
      alreadyRedeemedMessage: "æ‚¨å·²ç»é¢†å–è¿‡æ˜¥èŠ‚ä»£é‡‘åˆ¸äº†ï¼Œæ¯äººé™é¢†ä¸€æ¬¡å“¦~"
      expiredMessage: "æŠ±æ­‰ï¼Œæ˜¥èŠ‚ä»£é‡‘åˆ¸æ´»åŠ¨å·²ç»“æŸã€‚"
      quotaExhaustedMessage: "æŠ±æ­‰ï¼Œæ˜¥èŠ‚ä»£é‡‘åˆ¸å·²å‘æ”¾å®Œæ¯•ã€‚"
